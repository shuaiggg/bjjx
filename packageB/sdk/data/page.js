var auth=require("../auth"),eventEmitter=require("../eventEmitter"),docData=require("./doc"),serverPage=0,serverStep=0,clientPage=0,clientStep=0,maxPage=0,maxStep=0;exports.init=function(e){eventEmitter.on(eventEmitter.SERVER_PAGE_CHANGE,function(e,t){var r=docData.getSimplePage(t.docId,t.page).page;serverPage=clientPage=r,serverStep=clientStep=t.step}).on(eventEmitter.CLIENT_PAGE_CHANGE,function(e,t){var r=docData.getSimplePage(t.docId,t.page).page;clientPage=r,clientStep=t.step}).on(eventEmitter.MAX_PAGE_CHANGE,function(e,t){maxPage=t.page,maxStep=t.step})},exports.hasPrevPage=function(e){return 0<e},exports.hasNextPage=function(e){return auth.canServerPage()?e<docData.getWhiteboardCount()+docData.getDocumentCount()-1:e<serverPage},exports.prevPage=function(){if(exports.hasPrevPage(clientPage))return clientPage--,!0},exports.nextPage=function(){if(exports.hasNextPage(clientPage))return clientPage++,!0},exports.getClientPage=function(){return clientPage},exports.getClientStep=function(){return clientStep},exports.getServerPage=function(){return serverPage},exports.getServerStep=function(){return serverStep},exports.getMaxPage=function(){return maxPage},exports.getMaxStep=function(){return maxStep},exports.getPageList=function(e){for(var t=docData.getComplexPage(e),r=t.page,a=t.docId,n=[],g=0;g<=a;g++){var o=docData.getDocumentById(g);if(o){var i=o.pageList;if(g==a)var p=r+1;else p=i.length;for(var c=0;c<p;c++){var u=i[c];u.page=docData.getSimplePage(g,c).page,n.push(u)}}}return n};