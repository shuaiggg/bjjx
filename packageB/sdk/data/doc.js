var toNumber=require("../function/toNumber"),store=require("../store"),config=require("../config"),storage=require("../storage"),eventEmitter=require("../eventEmitter"),$=require("../jquery"),raw=[],settings={},LOCAL_DOC_QUALITY="bjy_doc_image_quality",LOCAL_DOC_FIT="bjy_doc_image_fit";function getDocumentById(r){var n;return $.each(raw,function(t,e){if(r==e.id)return n=e,!1}),n}function simple2Complex(r){var n,o,i=0;return $.each(raw,function(t,e){if(o=i+e.pageList.length,i<=r&&r<o)return n=e,!1;i=o}),{docId:n.id,page:r-i,pptUrl:n.pptUrl,pageList:n.pageList}}function complex2Simple(r,n){var o={page:-1};return $.each(raw,function(t,e){if(e.id==r)return o.pptUrl=e.pptUrl,o.page+=n+1,!1;o.page+=e.pageList.length}),o}exports.init=function(){exports.clear(),settings.quality=config.DOC_QUALITY_LOW,settings.fit=toNumber(storage.get(LOCAL_DOC_FIT),config.DOC_FIT_VIEW)},exports.clear=function(){raw=[]},exports.add=function(t){$.isArray(t)||(t=[t]),$.merge(raw,t)},exports.update=function(t,e){getDocumentById(t).extra=e},exports.remove=function(r){var n;return $.each(raw,function(t,e){e.id==r&&(n=t)}),0<=n&&raw.splice(n,1)[0]},exports.getQuality=function(){return settings.quality},exports.setQuality=function(t){settings.quality=t},exports.getFit=function(){return settings.fit},exports.setFit=function(t){settings.fit=t,storage.set(LOCAL_DOC_FIT,t)},exports.getWhiteboardCount=function(){return 1},exports.getDocumentCount=function(){var r=0;return $.each(exports.getDocumentList(),function(t,e){r+=e.pageList.length}),r},exports.getWhiteboardList=function(){return raw.slice(0,exports.getWhiteboardCount())},exports.getDocumentList=function(){return raw.slice(exports.getWhiteboardCount())},exports.getPageInfoByPage=function(t){var e=simple2Complex(t);return exports.getPageInfoByDoc(e.docId,e.page)},exports.getDocumentById=getDocumentById,exports.getPageInfoByDoc=function(t,e){return getDocumentById(t).pageList[e]},exports.getDocumentById=function(t,e){return getDocumentById(t)},exports.getSimplePage=function(t,e){return complex2Simple(t,e)},exports.getComplexPage=function(t){return simple2Complex(t)};