var bjy=require("../../bjy"),liveServer=require("../../server/live"),eventEmitter=bjy.eventEmitter,serverData=bjy.data.server,language=require("../../language/main")();Component({data:{options:[{key:"",name:""},{key:"",name:""},{key:"",name:""}],current:"",showOptions:!1},ready:function(){this.bindEvent()},methods:{bindEvent:function(){var a=this;eventEmitter.on(eventEmitter.SERVER_INFO_FETCH_SUCCESS,function(){for(var e,t=serverData.getLiveServerList(),r=[],n=0;e=t[n++];)r.push({key:e.pull,name:language.LINK+n});a.setData({options:r,currentObj:r[0]})})},onValueTap:function(){console.log("on switch tap"),this.setData({showOptions:!this.data.showOptions})},onOptionTap:function(e){var t=this,r=e.target.dataset.key;t.data.currentObj.key!==r?(t.setData({currentObj:t.findByKey(r),showOptions:!1}),t.triggerEvent("optionTap",t.data.currentObj),liveServer.setActiveDownlinkServer(t.findServerByKey(r)),eventEmitter.trigger(eventEmitter.DOWNLINK_SERVER_CHANGE_TRIGGER,{server:t.data.currentObj.key})):t.setData({showOptions:!1})},findByKey:function(e){for(var t,r=this.data.options,n=0;t=r[n++];)if(t.key==e)return t},findServerByKey:function(e){for(var t,r=serverData.getLiveServerList(),n=0;t=r[n++];)if(t.pull==e)return t}}});