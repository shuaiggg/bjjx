var eventEmitter=require("../../eventEmitter"),Queue=require("../../Queue"),appLanguage=require("../../language/main")(),pageLanguage=require("./language/main")(),$=require("../../jquery"),store=require("../../store");$.extend(pageLanguage,appLanguage),Component({properties:{styleInfo:{type:"Object",value:{showInfo:!0,strokeWidth:6,activeColor:"#1694ff",backgroundColor:"#d8d9d8"}}},data:{needHelp:!1,progress:0,statusTips:"",logoSrc:"",roomLoadEnded:!1},ready:function(){var t=this,n=new Queue({task:function(e,a){e.callback&&e.callback(e),a()}});t.queue=n,t.namespace=".loading"+Math.random();var s=0,E=20;eventEmitter.one(eventEmitter.INTERFACE_FETCH_SUCCESS+t.namespace,function(){t.setData({logoSrc:store.get("partner.logoPrefix")+"/m-loading.png"}),n.add({progress:++s*E,callback:function(e){t.setData({statusTips:pageLanguage.ENTER_DATA_SERVER_FETCH_SUCCESS,progress:e.progress})}})}).one(eventEmitter.INTERFACE_FETCH_FAIL+t.namespace,function(e,a){n.add({progress:++s*E,callback:function(e){t.setData({statusTips:a.msg,progress:e.progress})}})}).one(eventEmitter.MASTER_SERVER_CONNECT_SUCCESS+t.namespace,function(){n.add({progress:++s*E,callback:function(e){t.setData({statusTips:pageLanguage.ENTER_CLASSROOM_MASTER_SERVER_CONNECT_SUCCESS,progress:e.progress})}})}).one(eventEmitter.SERVER_INFO_FETCH_SUCCESS+t.namespace,function(){n.add({progress:++s*E,callback:function(e){t.setData({statusTips:pageLanguage.ENTER_CLASSROOM_SERVER_INFO_FETCH_SUCCESS,progress:e.progress})}})}).one(eventEmitter.ROOM_SERVER_CONNECT_SUCCESS+t.namespace,function(){n.add({progress:++s*E,callback:function(e){t.setData({statusTips:pageLanguage.ENTER_CLASSROOM_ROOM_SERVER_CONNECT_SUCCESS,progress:e.progress})}})}).one(eventEmitter.ROOM_SERVER_LOGIN_SUCCESS+t.namespace,function(){n.add({progress:++s*E,callback:function(e){t.setData({statusTips:pageLanguage.ENTER_CLASSROOM_ROOM_SERVER_LOGIN_SUCCESS,progress:e.progress,roomLoadEnded:!0}),setTimeout(function(){t.triggerEvent("loadEnded")},0)}})}).one(eventEmitter.ROOM_SERVER_LOGIN_FAIL+t.namespace,function(e,a){n.add({callback:function(e){t.setData({statusTips:pageLanguage.ENTER_CLASSROOM_ROOM_SERVER_LOGIN_FAIL,needHelp:!0})}})}).one(eventEmitter.ROOM_SERVER_LOGIN_OVERFLOW+t.namespace,function(e,a){n.add({callback:function(e){t.setData({statusTips:pageLanguage.ENTER_CLASSROOM_ROOM_SERVER_LOGIN_OVERFLOW,needHelp:!0})}})}).one(eventEmitter.ROOM_SERVER_LOGIN_KICKED_OUT+t.namespace,function(e,a){n.add({callback:function(e){t.setData({statusTips:pageLanguage.ENTER_CLASSROOM_ROOM_SERVER_LOGIN_KICKED_OUT,needHelp:!0})}})}).one(eventEmitter.CLASSROOM_CONNECT_FAIL+t.namespace,function(){n.add({callback:function(e){t.setData({statusTips:pageLanguage.ENTER_CLASSROOM_TIMEOUT_FAIL,needHelp:!0})}})})},beforeDestroy:function(){eventEmitter.off(this.namespace),this.queue.dispose()},methods:{}});